---
clayout: post
title:  "符号执行从入门到放弃"
date:   2019-11-6
desc: ""
keywords: ""
categories: [Binary]
tags: [pwn]
icon: icon-html
---

# 符号执行从入门到放弃

工地洋文

> > Cadar C , Sen K . Symbolic execution for software testing: Three decades later[J]. Communications of the ACM, 2013, 56(2):82-90.
> >
> > Baldoni R , Coppa E , D’elia, Daniele Cono, et al. A Survey of Symbolic Execution Techniques[J]. ACM Computing Surveys, 2018, 51(3):1-39.

## 基本原理

在不执行程序的前提下，用符号值表示程序变量的值，然后模拟程序执行来进行相关分析

使用符号执行分析一个程序时，使用符号值作为输入，而非一般执行程序时使用的具体值。在达到目标代码时，分析器可以得到相应的路径约束，然后通过约束求解器来得到可以触发目标代码的具体值。



```c
void foobar (int a, int b) {
	int x = 1, y = 0;
	if (a != 0) {
		y = 3 + x;
		if (b == 0)
			x = 2 * (a + b);
	}
	assert (x-y != 0);
}
```

对于foobar，确定哪些输入参数可以使assert失败

a、b两个四字节参数，每个有$2^{32}$种情况，若随机生成并执行程序，不太可能准确的获得使断言失败的输入，遍历所有情况也不可行。但符号执行克服了这些限制，并且可以推断出所有的输入而不是单个输入值

通过静态分析代码不能确定的值（例如函数的实际参数和从流中读取数据的系统调用的结果），用符号$α_i$表示

在任何时候，符号执行引擎都维持着一个状态$(stmt,σ,π)$

其中

1. stmt是下一条要执行的语句，目前假设它可以是赋值、条件分支或跳转

2. σ是一个符号储存，它将程序变量与具体值的表达式或$α_i$的表达式相关联

   如图，对于B，a与$α_i$的表达式$α_a$关联，x与具体值的表达式1相关联

3. π表示路径约束，表示在执行中能够到达stmt的$α_i$的表达式，初始为True

   如图，对于C，若要到达stmt(y=3+x)，需要使$α_a≠0$

![1](D:\Ai\GitHub\images\符号执行\1.jpg)

得到三种结果，只有一种可以使断言失败，通过约束求解可以得到$α_a$和$α_b$的具体值$(2,0)$



