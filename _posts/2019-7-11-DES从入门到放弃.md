---
![6](https://raw.githubusercontent.com/AiDaiP/images/master/des/6.png)layout: post
title:  "DES基本操作"
date:   2019-7-11
desc: ""
keywords: ""
categories: [Crypto]
tags: [Crypto,DES]
icon: icon-html
---

# DES基本操作

* #### 基本操作

  ![7](https://raw.githubusercontent.com/AiDaiP/images/master/des/7.png)

* #### IP置换表

  ![2](https://raw.githubusercontent.com/AiDaiP/images/master/des/2.png)

  

  

* #### 扩展运算

  ![4](https://raw.githubusercontent.com/AiDaiP/images/master/des/4.png)

  方框内为32bit原始数据，扩展后为48bit

* #### S盒置换

  ![5](https://raw.githubusercontent.com/AiDaiP/images/master/des/5.png)

  ![8](https://raw.githubusercontent.com/AiDaiP/images/master/des/8.png)

  ![6](https://raw.githubusercontent.com/AiDaiP/images/master/des/6.png)

  输入6bit，第一位和第六位组成一个二进制数对应S盒中的行号，三四五位组成一个二进制数对应S盒中的列号，交叉点的数据是是该盒的输出

  对于上图S1盒，输入0b101011，输出0b1001

* #### P盒置换

  ![9](https://raw.githubusercontent.com/AiDaiP/images/master/des/9.png)

  把输入的每位映射到输出位

  输入0001 0000 1010 0001 0000 0000 0000 0001

  输出1000 0000 0000 0000 0000 1000 1000 0110

* #### 子密钥生成

  ![10](https://raw.githubusercontent.com/AiDaiP/images/master/des/10.png)

  ![11](https://raw.githubusercontent.com/AiDaiP/images/master/des/11.png)

* #### 3DES

  使用三个密钥，执行三次DES算法

  加密过程：加密-解密-加密

  $C=Ek_3(Dk_2(Ek_1(P))) $

  解密过程：解密-加密-解密 

  $P=Dk_1(EK_2(Dk_3(C))) $

* #### 加密模式

  * #####  ECB

    电子密本方式，将数据按照8个字节一组分组进行DES加密或解密，之后按顺序连接

  * ##### CBC

    将数据按8个字节一组分组

    第一组数据与向量I异或后的结果进行DES加密得到第一组密文C1

    第二组数据与C1异或后的结果进行DES加密得到第二组密文C2

    以此类推，最后将密文按顺序连接

    * 加密：

      $ C_1 = Enc(Key, XOR(IV, P_1) $

      $C_i = Enc(Key, XOR(C_{i-1}, P_i) $

    * 解密

      $P_1 = XOR(IV, Dec(Key, C_1)) $

      $ P_i = XOR(C_{i-1}, Dec(Key,C_i)) $

  * 

* #### 填充

  * ##### ZeroPadding 

    数据长度不对齐时使用0填充，否则不填充。

  * ##### PKCS7Padding

    假设数据长度需要填充n(n>0)个字节才对齐，那么填充n个字节，每个字节都是n;如果数据本身就已经对齐了，则填充一块长度为块大小的数据，每个字节都是块大小。 

  * ##### PKCS5Padding 

    PKCS7Padding的子集，块大小固定为8字节。 