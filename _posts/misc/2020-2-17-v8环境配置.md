---
layout: post
title:  "v8环境配置"
date:   2020-2-17
desc: ""
keywords: ""
categories: [Misc]
tags: [v8]
icon: icon-html
---

# v8环境配置

不能用wsl

.vpython-root/a91fc4/bin/python": cannot allocate memory

https://github.com/Microsoft/WSL/issues/3072

https://github.com/microsoft/WSL/issues/2959

至今未解决

需要科学上网

全局代理

```
vim ~/.bashrc
export http_proxy=http://127.0.0.1:8081
export https_proxy=http://127.0.0.1:8081
source ~/.bashrc
```

git代理

```
git config --global https.proxy http://127.0.0.1:8081
git config --global https.proxy https://127.0.0.1:8081
```

depot_tools 

```
git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git
echo 'export PATH=$PATH:"/path/to/depot_tools"' >> ~/.bashrc
source ~/.bashrc
gclient
```

ninja

```
git clone https://github.com/ninja-build/ninja.git
cd ninja && ./configure.py --bootstrap
echo 'export PATH=$PATH:"/path/to/ninja"' >> ~/.bashrc
source ~/.bashrc
```

编译v8

```
fetch v8
#回滚
#git reset --hard 版本
#添加diff补丁
#git apply < wdnmd.diff
cd v8
gclient sync
```



### 报错与解决方案

* fetch时no such file

  代理没整好

* curl: (35) OpenSSL SSL_connect: SSL_ERROR_SYSCALL

  ```
  vim ~/.bashrc
  export http_proxy=http://127.0.0.1:8081
  export https_proxy=http://127.0.0.1:8081
  source ~/.bashrc
  ```

* gclient sync Error: client not configured; see 'gclient config'

  进depot_tools目录创建.gclient

  ```
  solutions = [
    { "name"        : 'v8',
      "url"         : 'https://chromium.googlesource.com/v8/v8',
      "deps_file"   : 'DEPS',
      "managed"     : True,
      "custom_deps" : {
      },
      "custom_vars": {},
    },
  ]
  
  ```

  



